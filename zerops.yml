zerops:
  - setup: zaia
    run:
      os: ubuntu
      base: nodejs@22
      prepareCommands:
        - curl -fsSL https://github.com/block/goose/releases/download/stable/download_cli.sh | bash
        - sudo apt-get update -y
        - sudo apt-get install -y chromium-browser jq
        - sudo wget https://github.com/mikefarah/yq/releases/latest/download/yq_linux_amd64 -O /usr/bin/yq && sudo chmod +x /usr/bin/yq
        - sudo npm install -g puppeteer
        - sudo apt-get clean -y
        - sudo rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*
        - mkdir -p ~/.config/goose
        - mkdir -p ~/.ssh
        - |
          cat > ~/.ssh/config << 'EOF'
          Host *
              StrictHostKeyChecking no
              UserKnownHostsFile /dev/null
          EOF
        - |
          cat > ~/.config/goose/config.yaml << 'EOF'
          extensions:
            developer:
              bundled: true
              enabled: true
              name: developer
              timeout: 300
              type: builtin

            memory:
              bundled: true
              enabled: true
              name: memory
              timeout: 300
              type: builtin
          EOF
      envVariables:
        GOOSE_PROVIDER: anthropic
        GOOSE_MODEL: claude-sonnet-4-20250514
        GOOSE_TEMPERATURE: 0.3
        GOOSE_DISABLE_KEYRING: true
        CONFIGURE: false
        PUPPETEER_EXECUTABLE_PATH: /usr/bin/chromium-browser
        PUPPETEER_SKIP_CHROMIUM_DOWNLOAD: true
        CHROME_DEVEL_SANDBOX: /usr/lib/chromium-browser/chrome-sandbox
      start: zsc noop --silent
